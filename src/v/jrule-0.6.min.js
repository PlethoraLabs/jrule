(function(){var t,e,s,o={}.hasOwnProperty,r=function(t,e){function s(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return s.prototype=e.prototype,t.prototype=new s,t.__super__=e.prototype,t};s={},s.set_text=function(t,e){return t.innerText?t.innerText=e:t.textContent=e},s.add_events=function(t,e){var s,o,r,i;for(i=[],o=0,r=t.length;r>o;o++)s=t[o],i.push(null!=e?e.addEventListener(s.type,s.fn):document.addEventListener(s.type,s.fn));return i},s.remove_events=function(t,e){var s,o,r,i;for(i=[],o=0,r=t.length;r>o;o++)s=t[o],i.push(null!=e?e.removeEventListener(s.type,s.fn):document.removeEventListener(s.type,s.fn));return i},s.apply_styles=function(t,e){var s,o,r;r=[];for(s in e)o=e[s],r.push(t.style[s]=o);return r},s.extend=function(t,e){var s,o;null==t&&(t={}),null==e&&(e={});for(s in e)o=e[s],t[s]=o;return t},s.defaults=function(t,e){var s,o;null==e&&(e={});for(s in t)o=t[s],e.hasOwnProperty(s)||(e[s]=o);return e},t=function(){function t(e){this.opts=null!=e?e:{},this.setup_border_rulers(),this.setup_caliper(),this.setup_grid(),this.setup_mandolin(),this.mouse_tracker=t.MouseTracker.get_tracker(),this.setup_events(),"undefined"!=typeof console&&null!==console&&console.log("jrule ready!"),t.Messenger.notify("jrule ready!"),t.Messenger.notify('Press "h" to view help')}return t.talkative=1,t.version=.6,t.zIndex=999999,t.prototype.default_opts=function(){},t.prototype.destroy=function(){return this.caliper&&this.caliper.destroy(),this.border_rulers&&this.border_rulers.destroy(),this.grid&&this.grid.destroy(),this.mouse_tracker&&this.mouse_tracker.destroy(),this.mandolin&&this.mandolin.destroy(),document.jruler=void 0,"undefined"!=typeof console&&null!==console?console.log("Venni Vetti Vecci"):void 0},t.prototype.setup_events=function(){var e;return this.events||(this.events=[]),e=function(e){return function(s){return 67===s.keyCode?e.toggle_crosshairs():82===s.keyCode?e.toggle_rulers():71===s.keyCode?e.toggle_grid():72===s.keyCode?e.toggle_help():77===s.keyCode?(t.talkative=!t.talkative,t.Messenger.notify("Messages "+(t.talkative?"on":"off"),{duration:1e3,force:!0})):27===s.keyCode?e.destroy():void 0}}(this),this.events.push({type:"keydown",fn:e}),s.add_events(this.events)},t.prototype.setup_border_rulers=function(){return this.border_rulers=new t.BorderRulers},t.prototype.setup_caliper=function(){return this.caliper=new t.Caliper},t.prototype.setup_grid=function(){return this.grid=new t.Grid},t.prototype.setup_mandolin=function(){return this.mandolin=new t.Mandolin},t.prototype.toggle_crosshairs=function(){var e;return e=this.mouse_tracker.toggle_crosshairs(),t.Messenger.notify("Crosshairs "+(e?"on":"off"),{duration:1e3})},t.prototype.toggle_rulers=function(){var e;return e=this.border_rulers.toggle_visibility(),t.Messenger.notify("Rulers "+(e?"on":"off"),{duration:1e3})},t.prototype.toggle_grid=function(){var e;return e=this.grid.toggle_grid(),t.Messenger.notify("Grid "+(e?"on":"off"),{duration:1e3})},t.prototype.toggle_help=function(){return t.Help.get().toggle()},t.prototype.config=function(t,e){var s,o,r,i;null==e&&(e={}),o="crosshairs"===t?this.mouse_tracker.config_items():"rulers"===t?this.border_rulers.config_items():void 0,i=[];for(s in e)if(r=e[s],o.indexOf(s)>-1)switch(t){case"crosshairs":i.push(this.mouse_tracker.config(s,r));break;case"rulers":i.push(this.border_rulers.config(s,r));break;default:i.push(void 0)}else i.push(void 0);return i},t.prototype.config_items=function(){var t,e;return t=this.mouse_tracker.config_items(),e=this.border_rulers.config_items(),[["crosshair",t],["ruler",e]]},t}(),t.GUIObject=function(){function e(t){this.opts=null!=t?t:{},this.default_opts(),this.create(),this.setup_events()}return e.prototype.destroy=function(){return s.remove_events(this.events),document.body.removeChild(this.container),this.destroyed=!0},e.prototype.default_opts=function(){},e.prototype.setup_events=function(){return this.events||(this.events=[]),s.add_events(this.events,this.container)},e.prototype.classes=function(){return[]},e.prototype.create=function(){var t;return t=document.createElement("div"),t.className=this.classes().join(" "),this.container=t,document.body.appendChild(this.container),s.apply_styles(this.container,this.style())},e.prototype.style=function(){return{position:"fixed",backgroundColor:"rgba(0, 0, 0, .6)",padding:"8px 12px",fontSize:"14px",fontFamily:"sans-serif",color:"#fff",cursor:"pointer",zIndex:t.zIndex+10}},e.prototype.show=function(){return this.container.style.display="block",this.visible=!0},e.prototype.hide=function(){return this.container.style.display="none",this.visible=!1},e.prototype.toggle=function(){return this.visible?this.hide():this.show()},e}(),t.ColorWheel=function(){function t(){}return t.rgb_string_to_hex=function(t){var e,s,o,r,i;for(null==t&&(t="255, 255, 255"),o=t.split(","),t=[],e=r=0,i=o.length;i>r;e=++r)s=o[e],t[e]=parseInt(s);return this.rgb_to_hex(t[0],t[1],t[2])},t.rgb_to_hex=function(t,e,s){var o,r;return null==t&&(t=0),null==e&&(e=0),null==s&&(s=0),o=function(t){return t=t.toString(16),1===t.length&&(t="0"+t),t},r=""+o(t)+o(e)+o(s)},t.hex_to_rgb=function(t){var e,s,o,r,i,n,h,u;if(null==t&&(t="ffffff"),t=t.replace("#",""),r=t,3===t.length)for(r="",h=0,u=t.length;u>h;h++)s=t[h],r+=s+s;return i=r.substr(0,2),o=r.substr(2,2),e=r.substr(4,2),n=""+parseInt(i,16)+", "+parseInt(o,16)+", "+parseInt(e,16)},t.hex_to_rgba=function(t,e){return null==t&&(t="fff"),null==e&&(e=1),this.hex_to_rgb(t)+(", "+e)},t}(),t.BorderRulers=function(){function e(e){this.opts=null!=e?e:{},this.rulers={},this.mouse_ticks={},this.mouse_tracker=t.MouseTracker.get_tracker(),this.default_opts(),this.setup_rulers(),this.setup_mouse_pos(),this.setup_events()}return e.prototype.default_opts=function(){var e;return e={style:{backgroundColor:"rgba("+t.ColorWheel.hex_to_rgba("#aaa",.5)+")",opacity:.5,tickColor:"#f8f8f8",mouseTickColor:"#00f"},top:!0,left:!0,right:!1,bottom:!1,tick_distance:200,rule_size:25,divisions:10,show_mouse:!0,show_labels:!0,start_in_center:!0},this.opts=e},e.prototype.config_items=function(){return["divisions","tick_distance","show_mouse","show_labels"]},e.prototype.config=function(t,e){switch(t){case"divisions":this.opts.divisions=e;break;case"tick_distance":this.opts.tick_distance=e;break;case"show_mouse":this.opts.show_mosue=e;break;case"show_labels":this.opts.show_labels=e}return this.setup_rulers(!0)},e.prototype.get_style=function(){return{backgroundColor:this.opts.style.backgroundColor,opacity:this.opts.style.opacity}},e.prototype.setup_rulers=function(e){var o,r,i,n,h,u,a;if(null==e&&(e=!1),!this.setup||e){this.setup&&e&&this.destroy_rulers(),o=function(e){return function(){var o,r;return o=document.createElement("div"),o.className="ruler",r=e.get_style(),s.extend(r,{position:"fixed",zIndex:t.zIndex}),s.apply_styles(o,r),o}}(this),this.opts.top&&(h=o(),s.apply_styles(h,{left:0,right:0,top:0,height:""+this.opts.rule_size+"px"}),this.rulers.top=h),this.opts.left&&(r=o(),s.apply_styles(r,{left:0,top:0,bottom:0,width:""+this.opts.rule_size+"px"}),this.rulers.left=r),u=this.rulers;for(i in u)n=u[i],null!=(a=document.body)&&a.appendChild(n);return this.setup_ticks(),this.shown=!0,this.setup=!0}},e.prototype.setup_events=function(){var t;return this.events||(this.events=[]),this.opts.show_mouse?(t=function(t){return function(e){return t.render()}}(this),this.events.push({type:"jrule:mousemove",fn:t}),s.add_events(this.events,document.body)):void 0},e.prototype.tick_style=function(t){var e;return e={position:"absolute",display:"block",backgroundColor:this.opts.style.tickColor},"top"===t||"bottom"===t?(e.width="1px",e.height="100%"):(e.width="100%",e.height="1px"),e},e.prototype.create_label=function(t,e){var o,r;return o=document.createElement("div"),o.className="tick_label",s.set_text(o,""+e+"px"),r={position:"absolute",fontSize:"10px",fontFamily:"sans-serif"},"top"===t?s.extend(r,{left:""+e+"px",bottom:"2px",marginLeft:"-14px"}):s.extend(r,{top:""+e+"px",left:"4px","-webkit-transform":"rotate(-90deg)",transform:"rotate(-90deg)","-moz-transform":"rotate(-90deg)"}),s.apply_styles(o,r),o},e.prototype.setup_ticks=function(){var t,e,s,o,r,i,n,h,u,a,c,p,l,d;for(s=document.body.getBoundingClientRect(),a=Math.ceil(s.width/this.opts.tick_distance),n=Math.round(s.width/a),e=Math.round(n/this.opts.divisions),l=["top","left"],d=[],c=0,p=l.length;p>c;c++)i=l[c],d.push(function(){var s,n;for(n=[],o=s=0;a>=0?a>s:s>a;o=a>=0?++s:--s)u=o*this.opts.tick_distance,this.draw_tick(i,u,1,{backgroundColor:"#666"}),this.opts.show_labels&&(h=this.create_label(i,u),this.rulers[i].appendChild(h)),n.push(function(){var s,o,n;for(n=[],r=s=1,o=this.opts.divisions;o>=1?o>=s:s>=o;r=o>=1?++s:--s)t=r*e+u,n.push(this.draw_tick(i,t,r%2?.3:.5));return n}.call(this));return n}.call(this));return d},e.prototype.setup_mouse_pos=function(){var e,o,r,i,n;return e=document.body.getBoundingClientRect(),this.opts.show_mouse?(this.rulers.hasOwnProperty("top")&&(r=this.create_tick("top",Math.round(e.width/2),1),r.style.backgroundColor=""+this.opts.style.mouseTickColor,this.mouse_ticks.x=r,this.rulers.top.appendChild(this.mouse_ticks.x)),this.rulers.hasOwnProperty("left")&&(i=this.create_tick("left",Math.round(e.width/2),1),i.style.backgroundColor=""+this.opts.style.mouseTickColor,this.mouse_ticks.y=i,this.rulers.left.appendChild(this.mouse_ticks.y)),o=document.createElement("div"),n={position:"fixed",zIndex:t.zIndex+1,left:0,top:0,padding:"6px",backgroundColor:"#888",color:"#fafafa",fontSize:"12px",fontFamily:"sans-serif",fontWeight:100},s.apply_styles(o,n),this.mouse_pos=o,document.body.appendChild(this.mouse_pos)):void 0},e.prototype.create_tick=function(t,e,o,r){var i,n;return null==o&&(o=1),null==r&&(r={}),i=document.createElement("div"),n=s.extend(this.tick_style(t),r),i.className="tick","top"===t||"bottom"===t?(n.left=""+e+"px",n.height=""+100*o+"%"):(n.top=""+e+"px",n.width=""+100*o+"%"),s.apply_styles(i,n),i},e.prototype.draw_tick=function(t,e,s,o){var r;return null==s&&(s=1),null==o&&(o={}),this.rulers.hasOwnProperty(t)?(r=this.create_tick(t,e,s,o),this.rulers[t].appendChild(r)):!1},e.prototype.destroy_rulers=function(){var t,e,s,o;s=this.rulers,o=[];for(t in s)e=s[t],o.push(document.body.removeChild(e));return o},e.prototype.destroy=function(){return s.remove_events(this.events,document.body),document.body.removeChild(this.mouse_pos),this.destroy_rulers()},e.prototype.render=function(){return this.opts.show_mouse?(this.mouse_ticks.x&&(this.mouse_ticks.x.style.left=""+this.mouse_tracker.mousex+"px"),this.mouse_ticks.y&&(this.mouse_ticks.y.style.top=""+this.mouse_tracker.mousey+"px"),s.set_text(this.mouse_pos,""+this.mouse_tracker.mousex+", "+this.mouse_tracker.mousey)):void 0},e.prototype.toggle_visibility=function(){var t,e,s;this.shown=!this.shown,s=this.rulers;for(e in s)t=s[e],t.style.display=this.shown?"block":"none";return this.shown},e}(),t.Caliper=function(){function e(e){this.opts=null!=e?e:{},this.mouse_tracker=t.MouseTracker.get_tracker(),this.crosshairs=[],this.boxes=[],this.setup_events()}return e.prototype.setup_events=function(){var e,o,r;return this.events||(this.events=[]),e=function(e){return function(s){var o,r;return o=function(){return e.measuring=!1,e.end_pos=[e.mouse_tracker.mousex,e.mouse_tracker.mousey],e.last_size=[Math.abs(e.end_pos[0]-e.start_pos[0]),Math.abs(e.end_pos[1]-e.start_pos[1])],t.Messenger.notify(""+e.last_size[0]+"x"+e.last_size[1]),document.removeEventListener("keyup",r)},r=function(){return o(),e.cleanup()},16===s.keyCode?(e.measuring=!0,e.start_pos=[e.mouse_tracker.mousex,e.mouse_tracker.mousey],e.mark_spot_with_crosshair(e.start_pos),document.body.style.cursor="none",e.setup_indicators(),document.addEventListener("keyup",r)):32===s.keyCode&&e.measuring?(s.preventDefault(),o(),e.draw_box([e.start_pos,e.end_pos]),console.log("new box!",e.start_pos,e.end_pos)):void 0}}(this),this.events.push({type:"keydown",fn:e}),o=function(t){return function(){return t.render()}}(this),r=function(t){return function(e){var s;return"jrule_caliper_box"===e.toElement.className?(s=e.toElement.dataset.index,s<t.boxes.length&&t.boxes.splice(s,1),document.body.removeChild(e.toElement)):void 0}}(this),this.events.push({type:"click",fn:r}),s.add_events(this.events),s.add_events([{type:"jrule:mousemove",fn:o}],document.body)},e.prototype.render=function(){var e,o,r,i,n,h,u,a;return this.measuring?(u=Math.min(this.mouse_tracker.mousex,this.start_pos[0]),a=Math.min(this.mouse_tracker.mousey,this.start_pos[1]),h=Math.max(this.mouse_tracker.mousex,this.start_pos[0])-Math.min(this.mouse_tracker.mousex,this.start_pos[0]),o=Math.max(this.mouse_tracker.mousey,this.start_pos[1])-Math.min(this.mouse_tracker.mousey,this.start_pos[1]),i={width:""+h+"px",height:""+o+"px",left:""+u+"px",top:""+a+"px",zIndex:t.zIndex},s.apply_styles(this.indicator,i),r={display:"block"},e=this.start_pos[0]>this.mouse_tracker.mousex?"left":"right",n=this.start_pos[1]>this.mouse_tracker.mousey?"up":"down",this.drag_direction=[e,n],"left"===e?(r.left=0,r.right="auto"):(r.right=0,r.left="auto"),"up"===n?(r.top=0,r.bottom="auto"):(r.bottom=0,r.top="auto"),s.apply_styles(this.indicator_size,r),s.set_text(this.indicator_size,""+h+", "+o)):void 0},e.prototype.draw_box=function(t,e){var o,r,i,n,h,u,a;return null==e&&(e=!0),u=Math.min(t[0][0],t[1][0]),a=Math.min(t[0][1],t[1][1]),h=Math.abs(t[0][0]-t[1][0]),o=Math.abs(t[0][1]-t[1][1]),r=this.create_box(u,a,h,o),console.log(r),document.body.appendChild(r),this.boxes.push(r),this.boxes[this.boxes.length-1].dataset.index=this.boxes.length-1,e?(i=document.createElement("div"),i.className="size_indicator",n={position:"absolute",top:"50%",fontSize:"16px",fontFamily:"sans-serif",color:"#fafafa",textAlign:"center",width:"100%"},s.apply_styles(i,n),s.set_text(i,""+h+"x"+o),r.appendChild(i)):void 0},e.prototype.create_box=function(e,o,r,i){var n,h;return n=document.createElement("div"),n.className="jrule_caliper_box",h={position:"fixed",left:""+e+"px",top:""+o+"px",width:""+r+"px",height:""+i+"px",backgroundColor:"rgba(100, 100, 100, .4)",zIndex:t.zIndex},s.apply_styles(n,h),n},e.prototype.setup_indicators=function(){var t,e;return this.indicator=this.create_box(this.start_pos[0],this.start_pos[1],1,1),document.body.appendChild(this.indicator),t=document.createElement("div"),e={position:"absolute",right:0,bottom:0,fontFamily:"sans-serif",fontSize:"12px",backgroundColor:"#000",color:"#fff",padding:"3px",zIndex:1},this.indicator_size=t,s.apply_styles(this.indicator_size,e),this.indicator.appendChild(this.indicator_size)},e.prototype.mark_spot_with_crosshair=function(e){var s,o,r,i,n;for(this.crosshairs.push(t.Crosshair.create("x",""+e[0]+"px")),this.crosshairs.push(t.Crosshair.create("y",""+e[1]+"px")),i=this.crosshairs,n=[],o=0,r=i.length;r>o;o++)s=i[o],n.push(document.body.appendChild(s));return n},e.prototype.cleanup=function(){var t,e,s,o;for(this.indicator.removeChild(this.indicator_size),document.body.removeChild(this.indicator),o=this.crosshairs,e=0,s=o.length;s>e;e++)t=o[e],document.body.removeChild(t);return this.crosshairs=[],document.body.style.cursor="default"},e.prototype.destroy=function(){var t,e,o,r,i,n,h,u,a;for(o=null,u=this.events,r=0,n=u.length;n>r;r++)e=u[r],"jrule:mousemove"===e.type&&(o=e);for(s.remove_events(this.events),o&&s.remove_events([{type:"jrule:mousemove",fn:o.fn}],document.body),a=this.boxes,i=0,h=a.length;h>i;i++)t=a[i],document.body.removeChild(t);return this.boxes=[]},e}(),t.Crosshair=function(){function e(){}return e.create=function(e,o,r){var i,n,h,u,a;null==o&&(o="50%"),null==r&&(r={}),h={crosshairColor:"rgba(100, 100, 100, .5)",crosshairThickness:1};for(n in h)a=h[n],r.hasOwnProperty(n)||(r[n]=a);return i=document.createElement("div"),u={position:"fixed",backgroundColor:""+r.crosshairColor,zIndex:t.zIndex},i.className="crosshair","x"===e||"horizontal"===e?s.extend(u,{width:""+r.crosshairThickness+"px",top:0,bottom:0,left:""+o}):s.extend(u,{height:""+r.crosshairThickness+"px",left:0,right:0,top:""+o}),s.apply_styles(i,u),i},e}(),t.Grid=function(){function e(t){this.opts=null!=t?t:{},this.default_opts(),this.setup_grid(),this.setup_events()}return e.prototype.default_opts=function(){var t,e,s,o,r,i;t={tick_distance:100,divisions:3,show:!1,start_in_center:!0,style:{tickLineColor:"rgba(191, 231, 243, .6)",divisionLineColor:"rgba(220, 220, 220, .3)",centerLineColor:"rgba(255, 0, 0, .3)"}};for(e in t)if(o=t[e],this.opts.hasOwnProperty(e)){if("object"==typeof this.opts[e]){i=this.opts[e];for(s in i)r=i[s],this.opts[e].hasOwnProperty(s)||(this.opts[e][e]=r)}}else this.opts[e]=o;return this.opts},e.prototype.setup_events=function(){var t;return this.events||(this.events=[]),this.window_resizing=!1,this.resize_to=null,t=function(t){return function(e){return t.window_resizing?(t.resize_to&&clearTimeout(t.resize_to),t.resize_to=setTimeout(function(){return t.window_resizing=!1,t.setup_grid(),t.show_ticks()},400)):(t.window_resizing=!0,t.cleanup())}}(this),s.add_events(this.events,window)},e.prototype.setup_grid=function(){var e,s,o,r,i,n,h,u,a,c,p,l,d,_,f,y,m,v,g,k;if(e=Math.round(document.documentElement.clientWidth/2),s=Math.round(document.documentElement.clientHeight/2),n=Math.ceil(document.documentElement.clientWidth/this.opts.tick_distance),o=this.opts.divisions>0?Math.round(this.opts.tick_distance/this.opts.divisions):0,this.ticks=[],this.opts.start_in_center&&(n/=2,this.ticks.push(t.Crosshair.create("x",""+e+"px",{crosshairColor:this.opts.style.centerLineColor})),this.ticks.push(t.Crosshair.create("y",""+s+"px",{crosshairColor:this.opts.style.centerLineColor})),this.opts.divisions>0))for(i=p=1,m=this.opts.divisions;m>=1?m>p:p>m;i=m>=1?++p:--p)this.ticks.push(t.Crosshair.create("x",""+(e+i*o)+"px",{crosshairColor:this.opts.style.divisionLineColor})),this.ticks.push(t.Crosshair.create("y",""+(s+i*o)+"px",{crosshairColor:this.opts.style.divisionLineColor})),this.ticks.push(t.Crosshair.create("x",""+(e-i*o)+"px",{crosshairColor:this.opts.style.divisionLineColor})),this.ticks.push(t.Crosshair.create("y",""+(s-i*o)+"px",{crosshairColor:this.opts.style.divisionLineColor}));for(r=l=1;n>=1?n>l:l>n;r=n>=1?++l:--l){if(h=r*this.opts.tick_distance,a=this.opts.start_in_center?e+h:h,c=this.opts.start_in_center?s+h:h,this.ticks.push(t.Crosshair.create("x",""+a+"px",{crosshairColor:this.opts.style.tickLineColor})),this.ticks.push(t.Crosshair.create("y",""+c+"px",{crosshairColor:this.opts.style.tickLineColor})),this.opts.divisions>0)for(i=d=1,v=this.opts.divisions;v>=1?v>d:d>v;i=v>=1?++d:--d)this.ticks.push(t.Crosshair.create("x",""+(a+i*o)+"px",{crosshairColor:this.opts.style.divisionLineColor})),this.ticks.push(t.Crosshair.create("y",""+(c+i*o)+"px",{crosshairColor:this.opts.style.divisionLineColor}));if(this.opts.start_in_center&&(this.ticks.push(t.Crosshair.create("x",""+(e-h)+"px",{crosshairColor:this.opts.style.tickLineColor})),this.ticks.push(t.Crosshair.create("y",""+(s-h)+"px",{crosshairColor:this.opts.style.tickLineColor})),this.opts.divisions>0))for(i=_=1,g=this.opts.divisions;g>=1?g>_:_>g;i=g>=1?++_:--_)this.ticks.push(t.Crosshair.create("x",""+(e-h-i*o)+"px",{crosshairColor:this.opts.style.divisionLineColor})),this.ticks.push(t.Crosshair.create("y",""+(s-h-i*o)+"px",{crosshairColor:this.opts.style.divisionLineColor}))}for(k=this.ticks,y=0,f=k.length;f>y;y++)u=k[y],document.body.appendChild(u);return this.opts.show?this.show_ticks():this.hide_ticks()},e.prototype.cleanup=function(){var t,e,s,o,r;for(o=this.ticks,r=[],e=0,s=o.length;s>e;e++)t=o[e],r.push(document.body.removeChild(t));return r},e.prototype.hide_ticks=function(){var t,e,s,o,r;for(this.shown=!1,o=this.ticks,r=[],e=0,s=o.length;s>e;e++)t=o[e],r.push(t.style.display="none");return r},e.prototype.show_ticks=function(){var t,e,s,o,r;for(this.shown=!0,o=this.ticks,r=[],e=0,s=o.length;s>e;e++)t=o[e],r.push(t.style.display="block");return r},e.prototype.toggle_grid=function(){return this.shown=!this.shown,this.shown?this.show_ticks():this.hide_ticks(),this.shown},e.prototype.destroy=function(){return this.cleanup(),s.remove_events(this.events,window)},e}(),t.Mandolin=function(){function e(e){this.opts=null!=e?e:{},this.slices=[],this.tracker=t.MouseTracker.get_tracker(),this.default_opts(),this.setup_events()}return e.prototype.default_opts=function(){var t;return t={snap:!1,snap_to:10,style:{sliceColor:"rgba(150, 150, 150, .5)"}},this.opts=s.defaults(t,this.opts)},e.prototype.setup_events=function(){var t;return this.events||(this.events=[]),t=function(t){return function(e){return 83===e.keyCode?t.create_slice_at_mouse():68===e.keyCode?t.create_divide_at_mouse():void 0}}(this),this.events.push({type:"keydown",fn:t}),s.add_events(this.events)},e.prototype.get_snap_for=function(t){var e,s,o;for(s=t,o=t%this.opts.snap_to===0,e=0;!o;)e+=1,(t+e)%this.opts.snap_to===0?(s=t+e,o=!0):(t-e)%this.opts.snap_to===0&&(s=t-e,o=!0);return s},e.prototype.create_slice=function(e){var s;return this.opts.snap&&(e=this.get_snap_for(e)),s=t.Crosshair.create("x",""+e+"px",{backgroundColor:this.opts.style.sliceColor}),t.Messenger.notify("Slice created at "+e+"px"),document.body.appendChild(s),this.slices.push(s)},e.prototype.create_divide=function(e){var s;return this.opts.snap&&(e=this.get_snap_for(e)),s=t.Crosshair.create("y",""+e+"px",{backgroundColor:this.opts.style.sliceColor}),t.Messenger.notify("Divide created at "+e+"px"),document.body.appendChild(s),this.slices.push(s)},e.prototype.create_slice_at_mouse=function(){return this.create_slice(this.tracker.mousex)},e.prototype.create_divide_at_mouse=function(){return this.create_divide(this.tracker.mousey)},e.prototype.clear_slices=function(){var t,e,s,o;for(o=this.slices,e=0,s=o.length;s>e;e++)t=o[e],document.body.removeChild(t);return this.slices=[]},e.prototype.hide_slices=function(){var t,e,s,o,r;for(o=this.slices,r=[],e=0,s=o.length;s>e;e++)t=o[e],r.push(t.style.display="none");return r},e.prototype.show_slices=function(){var t,e,s,o,r;for(o=this.slices,r=[],e=0,s=o.length;s>e;e++)t=o[e],r.push(t.style.display="block");return r},e.prototype.destroy=function(){return this.clear_slices(),s.remove_events(this.events)},e}(),t.Messenger=function(){function e(){}return e.notify=function(e,o){return null==o&&(o={}),t.talkative||o.force?(o.is_html&&(o.html_content=e,o.content=""),e=new t.Messenger.Notification(s.extend({content:e,is_flash:!0},o)),this.add_message_to_stack(e)):void 0},e.flash=function(e,o){return null==o&&(o={}),t.talkative||o.force?(o.is_html&&(o.html_content=e,o.content=""),e=new t.Messenger.Flash(s.extend({content:e,is_flash:!0},o)),this.add_message_to_stack(e)):void 0},e.add_message_to_stack=function(t){var e,s,o,r,i,n,h;if(this.message_stack||(this.message_stack=[]),this.message_stack.push(t),this.message_stack.length>1){for(r=36,o=!1,h=this.message_stack,e=i=0,n=h.length;n>i;e=++i)s=h[e],s?s.visible?(s.container.style.top=""+r+"px",r+=s.container.clientHeight+6):s.destroyed&&(delete this.message_stack[e],o=!0):o=!0;if(o)return this.cleanup_message_stack()}},e.cleanup_message_stack=function(){var t,e,s,o,r;for(t=[],r=this.message_stack,s=0,o=r.length;o>s;s++)e=r[s],e&&!e.destroyed&&t.push(e);return this.message_stack=t},e}(),t.Messenger.Message=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.setup_events=function(){var t,e,o;return this.events||(this.events=[]),this.container?(o=function(t){return function(e){return"a"===e.target.tagName.toLowerCase()?!0:(e.preventDefault(),t.hide())}}(this),this.events.push({type:"click",fn:o}),t=function(t){return function(e){return t.timeout?clearTimeout(t.timeout):void 0}}(this),this.events.push({type:"mouseenter",fn:t}),e=function(t){return function(e){return t.timeout=setTimeout(function(){return t.hide()},500)}}(this),this.events.push({type:"mouseleave",fn:e}),s.add_events(this.events,this.container)):void 0},e.prototype.default_opts=function(){var t;return t={content:"",html_content:!1,duration:5e3,show:!0,is_flash:!1,type:"",colors:{alert:"rgba(0, 0, 0, .75)",error:"rgba(0, 0, 0, .75)"}},this.opts=s.defaults(t,this.opts)},e.prototype.classes=function(){return["message",this.opts.type]},e.prototype.style=function(){var t;return t={display:"none"},this.opts.colors.hasOwnProperty(this.opts.type)&&(t.backgroundColor=this.opts.colors[this.opts.type]),s.extend(e.__super__.style.call(this),t)},e.prototype.create=function(){return e.__super__.create.apply(this,arguments),this.opts.html_content?this.container.innerHTML=this.opts.html_content:s.set_text(this.container,this.opts.content),this.opts.show?this.show():void 0},e.prototype.show=function(){return e.__super__.show.apply(this,arguments),this.opts.duration?this.timeout=setTimeout(function(t){return function(){return t.hide()}}(this),this.opts.duration):void 0},e.prototype.hide=function(){return e.__super__.hide.apply(this,arguments),this.timeout&&clearTimeout(this.timeout),this.opts.is_flash?this.destroy():void 0},e}(t.GUIObject),t.Messenger.Notification=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.style=function(){var t;return t={top:"36px",right:"10px",display:"none",borderRadius:"3px",minWidth:"200px",maxWidth:"300px",textAlign:"left"},s.extend(e.__super__.style.call(this),t)},e}(t.Messenger.Message),t.Messenger.Flash=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return r(e,t),e.prototype.style=function(){return s.extend(e.__super__.style.apply(this,arguments),{top:0,left:0,right:0,textAlign:"center",fontSize:"18px",padding:"12px",backgroundColor:"#333"})},e.prototype.default_opts=function(){return this.opts=s.extend(e.__super__.default_opts.apply(this,arguments),{is_flash:!0,duration:3e3})},e}(t.Messenger.Message),t.Help=function(e){function o(){return o.__super__.constructor.apply(this,arguments)}return r(o,e),o.get=function(){return this.help||(this.help=new t.Help)},o.prototype.default_opts=function(){var t;return t="Welcome to JRule! Thanks for using it. <br><br> JRule helps you measure and line things up. It's simple to use, here are some controls: <br> Press 'c' to toggle the Crosshairs<br> Press 'g' to toggle the Grid<br> Press 'r' to toggle the Rulers<br> Hold 'shift' and move the mouse to Measure<br> Press 'h' to see this message again<br> Press 'm' to toggle messages on/off Click this message to get rid of it<br> Press 'escape' to remove JRule when you're done<br>",s.extend(o.__super__.default_opts.apply(this,arguments),{html_content:t,is_flash:!1,show:!1,duration:0})},o}(t.Messenger.Notification),t.MouseTracker=function(){function e(t){this.opts=null!=t?t:{},this.crosshairs=null,this.default_opts(),this.setup_events(),this.opts.show_crosshairs&&this.setup_crosshairs()}return e.get_tracker=function(){return this.tracker||(this.tracker=new t.MouseTracker)},e.prototype.default_opts=function(){var t;return t={show_crosshairs:!0,style:{crosshairColor:"rgba(100, 100, 100, .6)",crosshairThickness:1}},s.defaults(t,this.opts)},e.prototype.setup_events=function(){var t,e;return this.events||(this.events=[]),e=function(t){return function(e){var s;return t.mousex=e.clientX,t.mousey=e.clientY,s=new Event("jrule:mousemove"),document.body.dispatchEvent(s),t.opts.show_crosshairs?t.render_crosshairs():void 0}}(this),this.events.push({type:"mousemove",fn:e}),t=function(t){return function(e){return 187===e.keyCode?t.increase_crosshair_size():189===e.keyCode?t.decrease_crosshair_size():void 0}}(this),this.events.push({type:"keydown",fn:t}),s.add_events(this.events)},e.prototype.increase_crosshair_size=function(){return this.opts.style.crosshairThickness+=1,this.update(),t.Messenger.notify(""+this.opts.style.crosshairThickness+"px",{duration:600})},e.prototype.decrease_crosshair_size=function(){return this.opts.style.crosshairThickness=Math.max(1,this.opts.style.crosshairThickness-1),this.update(),t.Messenger.notify(""+this.opts.style.crosshairThickness+"px",{duration:600})},e.prototype.setup_crosshairs=function(){var e,s,o,r;this.crosshairs={},this.crosshairs.x=t.Crosshair.create("x","50%",this.opts.style),this.crosshairs.y=t.Crosshair.create("y","50%",this.opts.style),o=this.crosshairs,r=[];for(s in o)e=o[s],r.push(document.body.appendChild(e));return r},e.prototype.render_crosshairs=function(){var t;return this.crosshairs||this.setup_crosshairs(),t=1===this.opts.style.crosshairThickness?0:Math.round(this.opts.style.crosshairThickness/2),this.crosshairs.x.style.left=""+(this.mousex-t)+"px",this.crosshairs.y.style.top=""+(this.mousey-t)+"px"},e.prototype.toggle_crosshairs=function(){return this.opts.show_crosshairs=!this.opts.show_crosshairs,this.opts.show_crosshairs||this.remove_crosshairs(),this.opts.show_crosshairs},e.prototype.remove_crosshairs=function(){var t,e,s;s=this.crosshairs;for(e in s)t=s[e],document.body.removeChild(t);return this.crosshairs=null},e.prototype.destroy=function(){return this.remove_crosshairs(),s.remove_events(this.events)},e.prototype.config_items=function(){return["crosshair_size","crosshair_color"]},e.prototype.config=function(t,e){switch(t){case"crosshair_size":this.opts.style.crosshairThickness=Math.max(1,parseInt(e));break;case"crosshair_color":this.opts.style.crosshairColor=e}return this.update(),this.render_crosshairs()},e.prototype.update=function(){var t,e,s,o,r;s=this.crosshairs;for(e in s)t=s[e],t.style.backgroundColor=this.opts.style.crosshairColor;return null!=(o=this.crosshairs.x)&&(o.style.width=""+this.opts.style.crosshairThickness+"px"),null!=(r=this.crosshairs.y)?r.style.height=""+this.opts.style.crosshairThickness+"px":void 0},e}(),document.JRule=t,e=function(){return document.jruler=new document.JRule},"complete"!==document.readyState?document.addEventListener("DOMContentLoaded",function(){return e()}):e()}).call(this);
//# sourceMappingURL=./main.map